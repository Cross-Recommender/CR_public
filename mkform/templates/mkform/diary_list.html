{% extends 'app/base.html' %}

{% block content %}
    <h1 class="mb-5">マイダイアリー</h1>
    {% for diary in diary_list %}
        {{ diary.text | linebreaksbr }} <span class="text-muted">{{ diary.created_at }}</span>

        <!-- コメント一覧と、コメントフォーム -->
        <div class="mt-3 ml-5">
            <!-- その日記へのコメントフォーム -->
            <form action="{% url 'app:comment_create' diary.pk %}" method="POST">
                {{ form }}
                <button type="submit">送信</button>
                {% csrf_token %}
            </form>

            <!-- その日記に紐づいたコメントを取り出す -->
            {% for comment in diary.comment_set.all %}
                {{ comment.text }} <span class="text-muted">{{ diary.created_at }}</span><br>
            {% endfor %}
        </div><!-- コメント一覧・コメントフォーム終わり -->

        <hr>
    {% endfor %}
{% endblock %}